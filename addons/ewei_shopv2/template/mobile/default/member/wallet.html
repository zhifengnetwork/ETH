{template '_header'}
<style type="text/css">
	.fui-header ~ .fui-content{
		background-color: #fff;
	}
	.qbadress {
		display: flex;
		-webkit-display: flex;
		margin: 0 0 0px 0;
		padding: 10px 3% 0 3%;
		background: white;
	}

	.qbadress .fui-content-title {
		flex: 1;
	}

	.qbadress .fui-content-box {
		flex: 3;
	}

	.fui-content-title:nth-of-type(1) {
		line-height: 39px;
		text-align: right;
	}

	.fui-content-title:nth-of-type(2) {
		line-height: 39px;
	}

	.fui-content-box input {
		height: 39px;
		width: 100%;
		display: block;
		padding: 0px;
		margin: 0px;
		border: 0px;
		float: left;
		font-size: 0.7rem;
		border-bottom: 1px solid #ccc;
		padding-left: 3%;
	}

	.pic {
		padding-left: 3%;
	}

	.pic img {
		width: 8rem;
		height: 8rem;
	}

	#imgFile0,
	#zfbimgFile0,
	#wximgFile0 {
		position: absolute;
		width: 8rem;
		height: 8rem;
		-webkit-tap-highlight-color: transparent;
		filter: alpha(Opacity=0);
		opacity: 0;
	}

	.btn-sub {
		width: 90%;
		position: relative;
		/*bottom:10%;*/
		left: 5%;
	}

	.fui-cell-group {
		margin-top: 0;
	}

	.zfgl {
		background: #f7f7f7;
		color: #333;
		border: 1px solid #dfdfdf;
		width: 90%;
		text-align: center;
		position: relative;
		left: 7%;
		padding: 9px;
		border-radius: 0.2rem;
	}
</style>
<div class='fui-page  fui-page-current'>

	<div class="fui-header">

		<div class="fui-header-left">

			<a class="back"></a>

		</div>

		<div class="title">支付管理</div>

		<div class="fui-header-right">&nbsp;</div>

	</div>

	<div class="fui-content">

		<!-- <div class="qbadress">
    		<div class="fui-content-title">
    			钱包地址:
    		</div>
    		<div class="fui-content-box">
    			<input type="text" name="qbadress" value="{$member['walletaddress']}" class="form-control ad" id="ad">
    		</div>
    	</div> -->

		<div class="qbadress">
			<div class="fui-content-title">
				银行卡卡号:
			</div>
			<div class="fui-content-box">
				<input type="text" name="qbadress" value="{$member['bankid']}" class="form-control ad" id="bankid">
			</div>
		</div>

		<div class="qbadress">
			<div class="fui-content-title">
				开户人:
			</div>
			<div class="fui-content-box">
				<input type="text" name="qbadress" value="{$member['bankname']}" class="form-control ad" id="bankname">
			</div>
		</div>

		<div class="qbadress">
			<div class="fui-content-title">
				开户行:
			</div>
			<div class="fui-content-box">
				<input type="text" name="qbadress" value="{$member['bank']}" class="form-control ad" id="bank">
			</div>
		</div>

		<!-- {if empty($template_flag)}
		<div class="fui-cell-group" style="    padding: 10px 3% 0 3%;">

			<div class="fui-cell" style="padding:0">

				<div class="fui-cell-label" style="flex: 1;text-align: right;">所在城市: </div>

				<div class="fui-cell-info" style="flex: 3;border-bottom: 1px solid #ccc;padding-left: 10px;height: 39px;line-height: 39px;">
					<input type="text"  class='fui-input'  id='city' name='city' placeholder="请选择城市"  value="{$member['province']} {$member['city']}" data-value="{if !empty($show_data)}{$member['datavalue']}{/if}" readonly/>
				</div>

			</div>

		</div>
		{/if} -->

		<!-- 钱包二维码 -->
		<!-- <div class="qbadress">
    		<div class="fui-content-title" >

    			钱包二维码:
    		</div>
    		<div class="fui-content-box">
    			<div class="pic qb">
					<div class="plus" style="position:relative">
						<i class="fa fa-plus" style="position:absolute;"></i>
						<input type="file" name='imgFile0' id='imgFile0' />
					</div>
					<div class="images">
						<img  src="{$member['walletcode']}" />

					</div>
					<input  type="hidden"  value="{$member['walletcode']}"  id="avatar"/>
				</div>
    		</div>
    	</div> -->

		<!-- 支付宝二维码 -->
		<div class="qbadress">
			<div class="fui-content-title">

				支付宝收款二维码:
			</div>
			<div class="fui-content-box">
				<div class="pic zfb">
					<div class="plus" style="position:relative">
						<i class="fa fa-plus" style="position:absolute;"></i>
						<input type="file" name='zfbimgFile0' id='zfbimgFile0' />
					</div>
					<div class="images">
						<img src="{$member['zfbfile']}" />
						<!-- <img  src="../addons/ewei_shopv2/static/images/upload.png"  /> -->
						<!-- upload.png为默认图片 -->

					</div>
					<!-- input无图时为空 -->
					<input type="hidden" value="{$member['zfbfile']}" id="zfbavatar" />
				</div>
			</div>
		</div>
		<!-- 微信二维码 -->
		<div class="qbadress">
			<div class="fui-content-title">

				微信收款二维码:
			</div>
			<div class="fui-content-box">
				<div class="pic wx">
					<div class="plus" style="position:relative">
						<i class="fa fa-plus" style="position:absolute;"></i>
						<input type="file" name='wximgFile0' id='wximgFile0' />
					</div>
					<div class="images">
						<img src="{$member['wxfile']}" />
						<!-- <img  src="../addons/ewei_shopv2/static/images/upload.png"  /> -->
						<!-- upload.png为默认图片 -->

					</div>
					<!-- input无图时为空 -->
					<input type="hidden" value="{$member['wxfile']}" id="wxavatar" />
				</div>
			</div>
		</div>



		<div class="qbadress">
			<button class="btn btn-default btn-sub">确定</button>
		</div>


	</div>


	<script>
		// require(['biz/member/wallet'], function (modal) {
		// 	modal.init({});
		// })

		require(['core'], function (core) {
			var wximg = $('.wx .images img');
			var zfbimg = $('.zfb .images img');
			var qbimg = $('.qb .images img');
			if ("{$member['wxfile']}" == '') {
				wximg.prop('src', '../addons/ewei_shopv2/static/images/upload.png')
			}
			if ("{$member['zfbfile']}" == '') {
				zfbimg.prop('src', '../addons/ewei_shopv2/static/images/upload.png')
			}
			// if("{$member['walletcode']}" == ''){
			// 	qbimg.prop('src','../addons/ewei_shopv2/static/images/upload.png')
			// }
			/*图片上传*/



			//支付宝二维码 
			$('#zfbimgFile0').change(function () {
				// core.loading('正在上传');

				var comment = $(this).closest('.comment_main');
				var ogid = comment.data('ogid');

				$.ajaxFileUpload({
					url: core.getUrl('util/uploader'),
					data: { file: "zfbimgFile0" },
					secureuri: false,
					fileElementId: 'zfbimgFile0',
					dataType: 'json',
					success: function (res, status) {
						var src2 = $('.zfb .images img').prop('src');
						console.log(res.url);
						if (res.url == undefined) {
							return false;
						}
						// core.removeLoading();
						//var obj = $(tpl('tpl_img', res));
						var obj = document.createElement('img');
						obj.src = res.url;
						obj.style.width = '8rem';
						obj.style.height = '8rem';

						$('.zfb .images').html(' ');
						$('.zfb .images').append(obj);
						$('.zfb #zfbavatar').val(res.url);

					}, error: function (data, status, e) {
						// core.removeLoading();
						core.tip.show('上传失败!');
					}
				});
			});

			//微信二维码 
			$('#wximgFile0').change(function () {
				// core.loading('正在上传');

				var comment = $(this).closest('.comment_main');
				var ogid = comment.data('ogid');

				$.ajaxFileUpload({
					url: core.getUrl('util/uploader'),
					data: { file: "wximgFile0" },
					secureuri: false,
					fileElementId: 'wximgFile0',
					dataType: 'json',
					success: function (res, status) {
						var src2 = $('.wx .images img').prop('src');
						console.log(res.url);
						if (res.url == undefined) {
							return false;
						}
						// core.removeLoading();
						//var obj = $(tpl('tpl_img', res));
						var obj = document.createElement('img');
						obj.src = res.url;
						obj.style.width = '8rem';
						obj.style.height = '8rem';

						$('.wx .images').html(' ');
						$('.wx .images').append(obj);
						$('.wx #wxavatar').val(res.url);

					}, error: function (data, status, e) {
						// core.removeLoading();
						core.tip.show('上传失败!');
					}
				});
			});
			/*图片上传*/

			$('.btn-sub').click(function () {
				var adress = $('#ad').val();
				var url = $('#avatar').val();
				var zfbfile = $('#zfbavatar').val();
				var wxfile = $('#wxavatar').val();
				var bank = $('#bank').val();
				var bankid = $('#bankid').val();
				var bankname = $('#bankname').val();
				var city = $('#city').val();

				// if($('#ad').isEmpty()){
				// 	core.tip.show('请填写钱包地址！');
				// 	return false;
				// }
				if ($('#bank').isEmpty()) {
					core.tip.show('请填写开户行！');
					return false;
				}
				if ($('#bankid').isEmpty()) {
					core.tip.show('请填写银行卡号！');
					return false;
				}
				if ($('#bankname').isEmpty()) {
					core.tip.show('请填写开户人！');
					return false;
				}



				$.ajax({
					url: "{php echo mobileUrl('member/wallet/submit')}",
					type: 'post',
					data: { adress: adress, url: url, zfbfile: zfbfile, wxfile: wxfile, bankid: bankid, bankname: bankname, bank: bank },
					dataType: 'json',
					success: function (data) {
						if (data.status == 1) {
							core.tip.show('上传成功');
							setTimeout(function () {
								window.location.href = "{php echo mobileUrl('member/index')}";
							}, 1000)
						}
					}, error: function (e) {
						console.log(e)
					}
				})
			})
		})

	</script>

	<!--  -->

</div>



{template '_footer'}